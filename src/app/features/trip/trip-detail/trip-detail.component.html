<div class="container">
  <form [formGroup]="tripForm" (ngSubmit)="onSubmit()">
    <!-- General Trip Information -->
    <div class="section">
      <h2>Trip Details</h2>

      <mat-form-field>
        <mat-label>Trip Name</mat-label>
        <input matInput formControlName="name" />
      </mat-form-field>

      <mat-form-field>
        <mat-label>Duration</mat-label>
        <input matInput formControlName="duration" />
      </mat-form-field>

      <mat-form-field>
        <mat-label>Start Date</mat-label>
        <input
          matInput
          [matDatepicker]="startDatePicker"
          formControlName="startDate"
        />
        <mat-datepicker-toggle
          matSuffix
          [for]="startDatePicker"
        ></mat-datepicker-toggle>
        <mat-datepicker #startDatePicker></mat-datepicker>
      </mat-form-field>

      <mat-form-field>
        <mat-label>End Date</mat-label>
        <input
          matInput
          [matDatepicker]="endDatePicker"
          formControlName="endDate"
        />
        <mat-datepicker-toggle
          matSuffix
          [for]="endDatePicker"
        ></mat-datepicker-toggle>
        <mat-datepicker #endDatePicker></mat-datepicker>
      </mat-form-field>

      <mat-form-field>
        <mat-label>Status</mat-label>
        <mat-select formControlName="status">
          <mat-option value="draft">Draft</mat-option>
          <mat-option value="pending-approval">Pending Approval</mat-option>
          <mat-option value="approved">Approved</mat-option>
          <mat-option value="canceled">Canceled</mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field>
        <mat-label>Total Expense</mat-label>
        <input matInput type="number" formControlName="totalExpense" />
      </mat-form-field>
    </div>

    <div formGroupName="expenses">
      <!-- Car Rental Section -->
      <div class="section">
        <h2>Car Rental</h2>
        <div formGroupName="carRental">
          <mat-form-field>
            <mat-label>Car Name</mat-label>
            <input matInput formControlName="carName" />
          </mat-form-field>

          <mat-form-field>
            <mat-label>Pick-Up Date</mat-label>
            <input
              matInput
              [matDatepicker]="pickUpPicker"
              formControlName="pickUpDate"
            />
            <mat-datepicker-toggle
              matSuffix
              [for]="pickUpPicker"
            ></mat-datepicker-toggle>
            <mat-datepicker #pickUpPicker></mat-datepicker>
          </mat-form-field>

          <mat-form-field>
            <mat-label>Drop-Off Date</mat-label>
            <input
              matInput
              [matDatepicker]="dropOffPicker"
              formControlName="dropOffDate"
            />
            <mat-datepicker-toggle
              matSuffix
              [for]="dropOffPicker"
            ></mat-datepicker-toggle>
            <mat-datepicker #dropOffPicker></mat-datepicker>
          </mat-form-field>

          <mat-form-field>
            <mat-label>Pick-Up Location</mat-label>
            <input matInput formControlName="pickUpLocation" />
          </mat-form-field>

          <mat-form-field>
            <mat-label>Drop-Off Location</mat-label>
            <input matInput formControlName="dropOffLocation" />
          </mat-form-field>

          <mat-form-field>
            <mat-label>Total Price</mat-label>
            <input matInput type="number" formControlName="totalPrice" />
          </mat-form-field>
        </div>
      </div>

      <!-- Hotel Section -->
      <div class="section">
        <h2>Hotel</h2>
        <div formGroupName="hotel">
          <mat-form-field>
            <mat-label>Hotel Name</mat-label>
            <input matInput formControlName="hotelName" />
          </mat-form-field>

          <mat-form-field>
            <mat-label>Location</mat-label>
            <input matInput formControlName="location" />
          </mat-form-field>

          <mat-form-field>
            <mat-label>Check-In Date</mat-label>
            <input
              matInput
              [matDatepicker]="checkInPicker"
              formControlName="checkInDate"
            />
            <mat-datepicker-toggle
              matSuffix
              [for]="checkInPicker"
            ></mat-datepicker-toggle>
            <mat-datepicker #checkInPicker></mat-datepicker>
          </mat-form-field>

          <mat-form-field>
            <mat-label>Check-Out Date</mat-label>
            <input
              matInput
              [matDatepicker]="checkOutPicker"
              formControlName="checkOutDate"
            />
            <mat-datepicker-toggle
              matSuffix
              [for]="checkOutPicker"
            ></mat-datepicker-toggle>
            <mat-datepicker #checkOutPicker></mat-datepicker>
          </mat-form-field>

          <mat-form-field>
            <mat-label>Total Price</mat-label>
            <input matInput type="number" formControlName="totalPrice" />
          </mat-form-field>
        </div>
      </div>

      <!-- Flight Section -->
      <div class="section">
        <h2>Flight</h2>
        <div formGroupName="flight">
          <mat-form-field>
            <mat-label>Airline</mat-label>
            <input matInput formControlName="airline" />
          </mat-form-field>

          <mat-form-field>
            <mat-label>From</mat-label>
            <input matInput formControlName="from" />
          </mat-form-field>

          <mat-form-field>
            <mat-label>To</mat-label>
            <input matInput formControlName="to" />
          </mat-form-field>

          <mat-form-field>
            <mat-label>Departure Date</mat-label>
            <input
              matInput
              [matDatepicker]="departurePicker"
              formControlName="departureDate"
            />
            <mat-datepicker-toggle
              matSuffix
              [for]="departurePicker"
            ></mat-datepicker-toggle>
            <mat-datepicker #departurePicker></mat-datepicker>
          </mat-form-field>

          <mat-form-field>
            <mat-label>Arrival Date</mat-label>
            <input
              matInput
              [matDatepicker]="arrivalPicker"
              formControlName="arrivalDate"
            />
            <mat-datepicker-toggle
              matSuffix
              [for]="arrivalPicker"
            ></mat-datepicker-toggle>
            <mat-datepicker #arrivalPicker></mat-datepicker>
          </mat-form-field>

          <mat-form-field>
            <mat-label>Total Price</mat-label>
            <input matInput type="number" formControlName="totalPrice" />
          </mat-form-field>
        </div>
      </div>

      <!-- Taxi Section -->
      <div class="section">
        <h2>Taxi</h2>
        <div formGroupName="taxi">
          <mat-form-field>
            <mat-label>From</mat-label>
            <input matInput formControlName="from" />
          </mat-form-field>

          <mat-form-field>
            <mat-label>To</mat-label>
            <input matInput formControlName="to" />
          </mat-form-field>

          <mat-form-field>
            <mat-label>Time and Date</mat-label>
            <input
              matInput
              [matDatepicker]="taxiPicker"
              formControlName="timeAndDate"
            />
            <mat-datepicker-toggle
              matSuffix
              [for]="taxiPicker"
            ></mat-datepicker-toggle>
            <mat-datepicker #taxiPicker></mat-datepicker>
          </mat-form-field>

          <mat-form-field>
            <mat-label>Total Price</mat-label>
            <input matInput type="number" formControlName="totalPrice" />
          </mat-form-field>
        </div>
      </div>
    </div>

    <div class="section" *ngIf="isApprover">
      <hr class="mb-5" />
      <mat-form-field style="width: 100%">
        <mat-label>Comment</mat-label>
        <textarea
          matInput
          cdkTextareaAutosize
          placeholder="Leave a comment"
          formControlName="comment"
        ></textarea>
      </mat-form-field>
    </div>

    <div class="section" class="mt-6">
      <button mat-raised-button color="secondary" (click)="onBack()">
        Back
      </button>
      <div class="pull-right mb-3">
        <!-- Submit Button -->
        @if (isEndUser && !isTripSentForApproval) {
          <button
            mat-raised-button
            color="secondary"
            type="submit"
            class="mr-3"
            [disabled]="tripForm.invalid"
          >
            Save
          </button>
        }
        @if (isEndUser && !isTripSentForApproval && tripId) {
          <button
            mat-raised-button
            color="primary"
            type="button"
            [disabled]="tripForm.invalid"
            (click)="onSendForApproval()"
          >
            Send to Approver
          </button>
        }
        @if (isApprover && !isTripApproved && tripId) {
          <button
            mat-raised-button
            color="primary"
            type="button"
            [disabled]="tripForm.invalid"
            (click)="onApproveTrip()"
          >
            Approve
          </button>
        }
      </div>
    </div>
  </form>
</div>
